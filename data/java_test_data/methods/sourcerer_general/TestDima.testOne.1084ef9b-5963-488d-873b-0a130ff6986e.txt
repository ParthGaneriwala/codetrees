public void testOne() {
    try {
        Class.forName("org.hsqldb.jdbc.JDBCDriver");
        Connection conn = java.sql.DriverManager.getConnection("jdbc:hsqldb:file:/hsql/testdima/test", "sa", "");
        conn.setAutoCommit(false);
        Statement stat = conn.createStatement();
        stat.executeUpdate("DROP TABLE BAZ IF EXISTS");
        stat.executeUpdate("DROP TABLE BAR IF EXISTS");
        stat.executeUpdate("DROP TABLE FOO IF EXISTS");
        conn.commit();
        stat.executeUpdate("CHECKPOINT");
        stat.executeUpdate("CREATE CACHED TABLE FOO (ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, VAL VARCHAR(80))");
        stat.executeUpdate("CREATE TABLE BAR (ID INTEGER IDENTITY PRIMARY KEY, FOOID INTEGER NOT NULL, " + "VAL VARCHAR(80), FOREIGN KEY(FOOID) REFERENCES FOO(ID) ON DELETE CASCADE)");
        stat.executeUpdate("CREATE TABLE BAZ (ID INTEGER IDENTITY PRIMARY KEY, BARID INTEGER NOT NULL, " + "VAL VARCHAR(80), FOREIGN KEY(BARID) REFERENCES BAR(ID) ON DELETE CASCADE)");
        conn.commit();
        stat.executeUpdate("CHECKPOINT");
        stat.executeUpdate("INSERT INTO FOO (VAL) VALUES ('foo 1')");
        stat.executeUpdate("INSERT INTO BAR (FOOID,VAL) VALUES (IDENTITY(),'bar 1')");
        stat.executeUpdate("INSERT INTO BAZ (BARID,VAL) VALUES (IDENTITY(),'baz 1')");
        stat.executeUpdate("INSERT INTO FOO (VAL) VALUES ('foo 2')");
        stat.executeUpdate("INSERT INTO BAR (FOOID,VAL) VALUES (IDENTITY(),'bar 2')");
        stat.executeUpdate("INSERT INTO BAZ (BARID,VAL) VALUES (IDENTITY(),'baz 2')");
        stat.executeUpdate("INSERT INTO FOO (VAL) VALUES ('foo 3')");
        stat.executeUpdate("INSERT INTO BAR (FOOID,VAL) VALUES (IDENTITY(),'bar 3')");
        stat.executeUpdate("INSERT INTO BAZ (BARID,VAL) VALUES (IDENTITY(),'baz 3')");
        ResultSet rs;
        Statement query = conn.createStatement(java.sql.ResultSet.TYPE_SCROLL_INSENSITIVE, java.sql.ResultSet.CONCUR_READ_ONLY);
        rs = query.executeQuery("SELECT ID,VAL FROM FOO");
        System.out.println("Table FOO:");
        while (rs.next()) {
            System.out.println(rs.getInt(1));
            System.out.println(rs.getString(2));
        }
        rs = query.executeQuery("SELECT ID,FOOID,VAL FROM BAR");
        System.out.println("Table BAR:");
        while (rs.next()) {
            System.out.println(rs.getInt(1));
            System.out.println(rs.getInt(2));
            System.out.println(rs.getString(3));
        }
        rs = query.executeQuery("SELECT ID,BARID,VAL FROM BAZ");
        System.out.println("Table BAZ:");
        while (rs.next()) {
            System.out.println(rs.getInt(1));
            System.out.println(rs.getInt(2));
            System.out.println(rs.getString(3));
        }
        rs.close();
        query.close();
        stat.close();
        conn.close();
    } catch (Exception e) {
        System.err.println(e.getMessage());
        e.printStackTrace();
    }
}

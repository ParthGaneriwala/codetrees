public void testQueryOnlyOption() {
    GraphRDB g = new GraphRDB(conn, null, null, GraphRDB.OPTIMIZE_ALL_REIFICATIONS_AND_HIDE_NOTHING, false);
    model = new ModelRDB(g);
    Statement a1 = crAssertedStmt("s1", "p1", "o1");
    Statement a2 = crAssertedStmt("s2", "p2", "s1");
    Resource r1 = crReifiedStmt("r1", a1);
    Resource r2 = crReifiedStmt("r2", a2);
    // should find 10 statements total
    int cnt;
    Resource s1 = a1.getSubject();
    Property p1 = a1.getPredicate();
    RDFNode o1 = a1.getObject();
    cnt = countAll();
    assertTrue(cnt == 10);
    cnt = countSubj(s1);
    assertTrue(cnt == 1);
    cnt = countObj(o1);
    assertTrue(cnt == 2);
    cnt = countObj(s1);
    assertTrue(cnt == 3);
    cnt = countPred(p1);
    assertTrue(cnt == 1);
    cnt = countPred(RDF.predicate);
    assertTrue(cnt == 2);
    cnt = countSubj(r2);
    assertTrue(cnt == 4);
    model.setQueryOnlyAsserted(true);
    cnt = countAll();
    assertTrue(cnt == 2);
    cnt = countSubj(s1);
    assertTrue(cnt == 1);
    cnt = countObj(o1);
    assertTrue(cnt == 1);
    cnt = countObj(s1);
    assertTrue(cnt == 1);
    cnt = countPred(p1);
    assertTrue(cnt == 1);
    cnt = countPred(RDF.predicate);
    assertTrue(cnt == 0);
    cnt = countSubj(r2);
    assertTrue(cnt == 0);
    model.setQueryOnlyReified(true);
    cnt = countAll();
    assertTrue(cnt == 8);
    cnt = countSubj(s1);
    assertTrue(cnt == 0);
    cnt = countObj(o1);
    assertTrue(cnt == 1);
    cnt = countObj(s1);
    assertTrue(cnt == 2);
    cnt = countPred(p1);
    assertTrue(cnt == 0);
    cnt = countPred(RDF.predicate);
    assertTrue(cnt == 2);
    cnt = countSubj(r2);
    assertTrue(cnt == 4);
    model.setQueryOnlyReified(false);
    cnt = countAll();
    assertTrue(cnt == 10);
}

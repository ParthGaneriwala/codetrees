@Test
public void testConvertDataSetToBatchUpdateDataDTO() {
    DataSet dataSet = new DataSet("testDataSet");
    dataSet.addColumn("field1", DataTypes.STRING);
    dataSet.addColumn("field2", DataTypes.INT);
    dataSet.addColumn("field3", DataTypes.BOOLEAN);
    dataSet.addColumn("field4", DataTypes.LONG);
    dataSet.addColumn("field5", DataTypes.FLOAT);
    dataSet.addColumn("field6", DataTypes.DOUBLE);
    dataSet.addColumn("field7", DataTypes.BIG_DECIMAL);
    dataSet.addColumn("field8", DataTypes.DATE);
    dataSet.addColumn("field9", DataTypes.TIME);
    dataSet.addColumn("field10", DataTypes.DATE_TIME);
    dataSet.addColumn("field11", DataTypes.BLOB);
    dataSet.newRow();
    dataSet.set(0, "field1", "insert1");
    dataSet.set(0, "field2", Integer.MAX_VALUE);
    dataSet.set(0, "field3", false);
    dataSet.set(0, "field4", Long.MAX_VALUE);
    dataSet.set(0, "field5", Float.MAX_VALUE);
    dataSet.set(0, "field6", Double.MAX_VALUE);
    dataSet.set(0, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(0, "field8", Calendar.getInstance().getTime());
    dataSet.set(0, "field9", Calendar.getInstance().getTime());
    dataSet.set(0, "field10", Calendar.getInstance().getTime());
    dataSet.set(0, "field11", (new String("field11")).getBytes());
    dataSet.newRow();
    dataSet.set(1, "field1", "insert2");
    dataSet.set(1, "field2", Integer.MAX_VALUE);
    dataSet.set(1, "field3", false);
    dataSet.set(1, "field4", Long.MAX_VALUE);
    dataSet.set(1, "field5", Float.MAX_VALUE);
    dataSet.set(1, "field6", Double.MAX_VALUE);
    dataSet.set(1, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(1, "field8", Calendar.getInstance().getTime());
    dataSet.set(1, "field9", Calendar.getInstance().getTime());
    dataSet.set(1, "field10", Calendar.getInstance().getTime());
    dataSet.set(1, "field11", (new String("field11")).getBytes());
    dataSet.newRow();
    dataSet.set(2, "field1", "update1");
    dataSet.set(2, "field2", Integer.MAX_VALUE);
    dataSet.set(2, "field3", false);
    dataSet.set(2, "field4", Long.MAX_VALUE);
    dataSet.set(2, "field5", Float.MAX_VALUE);
    dataSet.set(2, "field6", Double.MAX_VALUE);
    dataSet.set(2, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(2, "field8", Calendar.getInstance().getTime());
    dataSet.set(2, "field9", Calendar.getInstance().getTime());
    dataSet.set(2, "field10", Calendar.getInstance().getTime());
    dataSet.set(2, "field11", (new String("field11")).getBytes());
    dataSet.newRow();
    dataSet.set(3, "field1", "update2");
    dataSet.set(3, "field2", Integer.MAX_VALUE);
    dataSet.set(3, "field3", false);
    dataSet.set(3, "field4", Long.MAX_VALUE);
    dataSet.set(3, "field5", Float.MAX_VALUE);
    dataSet.set(3, "field6", Double.MAX_VALUE);
    dataSet.set(3, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(3, "field8", Calendar.getInstance().getTime());
    dataSet.set(3, "field9", Calendar.getInstance().getTime());
    dataSet.set(3, "field10", Calendar.getInstance().getTime());
    dataSet.set(3, "field11", (new String("field11")).getBytes());
    dataSet.newRow();
    dataSet.set(4, "field1", "delete1");
    dataSet.set(4, "field2", Integer.MAX_VALUE);
    dataSet.set(4, "field3", false);
    dataSet.set(4, "field4", Long.MAX_VALUE);
    dataSet.set(4, "field5", Float.MAX_VALUE);
    dataSet.set(4, "field6", Double.MAX_VALUE);
    dataSet.set(4, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(4, "field8", Calendar.getInstance().getTime());
    dataSet.set(4, "field9", Calendar.getInstance().getTime());
    dataSet.set(4, "field10", Calendar.getInstance().getTime());
    dataSet.set(4, "field11", (new String("field11")).getBytes());
    dataSet.newRow();
    dataSet.set(5, "field1", "delete2");
    dataSet.set(5, "field2", Integer.MAX_VALUE);
    dataSet.set(5, "field3", false);
    dataSet.set(5, "field4", Long.MAX_VALUE);
    dataSet.set(5, "field5", Float.MAX_VALUE);
    dataSet.set(5, "field6", Double.MAX_VALUE);
    dataSet.set(5, "field7", BigDecimal.valueOf(Double.MAX_VALUE));
    dataSet.set(5, "field8", Calendar.getInstance().getTime());
    dataSet.set(5, "field9", Calendar.getInstance().getTime());
    dataSet.set(5, "field10", Calendar.getInstance().getTime());
    dataSet.set(5, "field11", (new String("field11")).getBytes());
    dataSet.startStoreDataChanges();
    dataSet.setRowType(0, DataSet.ROW_TYPE_INSERTED);
    dataSet.setRowType(1, DataSet.ROW_TYPE_INSERTED);
    dataSet.setRowType(2, DataSet.ROW_TYPE_UPDATED);
    dataSet.setRowType(3, DataSet.ROW_TYPE_UPDATED);
    dataSet.removeRow(5);
    dataSet.removeRow(4);
    try {
        BatchUpdateDataDTO batchUpdateDataDTO = XplatformUtils.convertDataSetToBatchUpdateDataDTO(dataSet, TestDTO.class);
        logger.debug("batchUpdateDataDTO: {}", batchUpdateDataDTO);
    } catch (Exception e) {
        e.printStackTrace();
        fail();
    }
}
